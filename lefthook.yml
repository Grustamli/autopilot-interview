commit-msg:
  commands:
    "lint commit message":
      run: pnpm commitlint --edit {1}

pre-push:
  parallel: true

  jobs:
    - name: BE
      group:
        piped: true
        jobs:
          - name: Generators
            run: task gen:be
            glob:
              - backends/**
              - go.mod
              - go.sum

          - name: Checks
            run: task check:be
            glob:
              - backends/**
              - go.mod
              - go.sum

          - name: Check for Uncommitted Changes (BE)
            run: git diff --exit-code
            silent: true


    - name: FE
      group:
        piped: true
        jobs:
          - name: Generators
            run: task gen:fe
            glob:
              - apps/**
              - packages/**
              - package.json
              - pnpm-lock.yaml
          - name: Biome Checks
            run: task check:biome

          - name: Checks
            run: task check:fe
            glob:
              - apps/**
              - packages/**
              - package.json
              - pnpm-lock.yaml

          - name: Check for Uncommitted Changes (FE)
            run: git diff --exit-code
            silent: true

    - name: Security Checks
      run: pnpm audit

    - name: Locale Checks
      run: task check:locales
      glob:
        - '**/locales/*/*.json'
        - '**/locales/*.json'
